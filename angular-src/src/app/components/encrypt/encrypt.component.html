<h2 class="page-header">Message Encryption </h2>
<div class="alert alert-info" role="alert">
  <p>
    This page demonstrates message encryption using one-time secret key which is changing continually depending on time.
    Server can recover the same one-time secret key and decrypt the ciphertext. Try to send the same message repeatedly,
    then check the changing of one-time secret key.
  </p>
</div>
<hr>
<form (ngSubmit)="onEncryptSubmit()">
  <div class="form-group">
    <label> Type in input message.</label>
    <textarea class="form-control" rows="5" [(ngModel)]="plaintext" name="plaintext"></textarea>
  </div>
  <input type="submit" class="btn btn-primary" value="Send Encrypted Message">
</form>
<hr>

<div class="alert alert-info" role="alert">
  <h4>Generated one-time secret key </h4>
  <p>{{key}}</p>
</div>

<div class="alert alert-warning" role="alert">
  <h4> Information sent to the server </h4>
  <p> - Public Token:
    <textarea class="form-control" rows="5"> {{ptoken}}</textarea>
  </p>
  <p> - Current Time: {{ctime}} </p>
  <p> - Ciphertext:
    <textarea class="form-control" rows="5"> {{encrypted}}</textarea>
  </p>
</div>

<div class="alert alert-success" role="alert">
  <h4> Server reply of decrypted message </h4>
  <textarea class="form-control" rows="5"> {{decrypted}}</textarea>
</div>
